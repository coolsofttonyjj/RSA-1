Version V.3.1
1) add test fun for automatic test
2) -50% memory usage
3) 30% speed improvement 
